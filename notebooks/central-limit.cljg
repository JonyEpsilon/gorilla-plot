;; gorilla-repl.fileformat = 1

;; **
;;; # Central limit theorem
;;; 
;;; We're going to look at the CLT in this worksheet, and simulate its action. Be reminded that
;;; 
;;; $$ \sum_i u_i \overset{d}\to N $$
;;; 
;;; where @@u_i@@ is a uniformly distributed random variable.
;; **

;; @@
(use 'gorilla-plot.core)
(use 'gorilla-test.core)
;; @@
;; =>
;;; nil
;; <=

;; @@
(defn r [] (- (apply + (repeatedly 50 rand)) 25))
;; @@
;; =>
;;; #'user/r
;; <=

;; @@
(def data (repeatedly 1000 r))
;; @@
;; =>
;;; #'user/data
;; <=

;; **
;;; Let's compare the simulated data and the expected distribution.
;; **

;; @@
(compose
 (histogram data :bins 50 :normalise :probability-density)
 (plot #(gaussian % 2 0) [-10 10]))
;; @@
;; =>
;;; {:gorilla-repl.types/vega {"width" 400, "height" 247.2188, "padding" {"left" 50, "bottom" 20, "top" 10, "right" 10}, "scales" [{"name" "x", "type" "linear", "range" "width", "domain" {"data" "1a68e00f-040a-43da-83c2-1c5f0c4c2ba0", "field" "data.x"}} {"name" "y", "type" "linear", "range" "height", "nice" true, "domain" {"data" "1a68e00f-040a-43da-83c2-1c5f0c4c2ba0", "field" "data.y"}}], "axes" [{"scale" "x", "type" "x"} {"scale" "y", "type" "y"}], "data" ({"name" "1a68e00f-040a-43da-83c2-1c5f0c4c2ba0", "values" ({"x" -6.4274659142927035, "y" 0} {"x" -6.171469995164695, "y" 0.007812624540315108} {"x" -5.915474076036686, "y" 0.0} {"x" -5.659478156908677, "y" 0.003906312270157554} {"x" -5.403482237780668, "y" 0.003906312270157554} {"x" -5.14748631865266, "y" 0.0} {"x" -4.891490399524651, "y" 0.015625249080630215} {"x" -4.635494480396642, "y" 0.007812624540315108} {"x" -4.379498561268633, "y" 0.01171893681047266} {"x" -4.1235026421406245, "y" 0.03125049816126043} {"x" -3.867506723012616, "y" 0.027344185891102876} {"x" -3.6115108038846078, "y" 0.027344185891102876} {"x" -3.3555148847565994, "y" 0.04296943497173309} {"x" -3.099518965628591, "y" 0.06250099632252086} {"x" -2.8435230465005827, "y" 0.07812624540315107} {"x" -2.5875271273725744, "y" 0.10156411902409639} {"x" -2.331531208244566, "y" 0.07812624540315107} {"x" -2.0755352891165577, "y" 0.1093767435644115} {"x" -1.8195393699885494, "y" 0.13672092945551437} {"x" -1.563543450860541, "y" 0.1601588030764597} {"x" -1.3075475317325327, "y" 0.17187773988693236} {"x" -1.0515516126045243, "y" 0.1601588030764597} {"x" -0.795555693476516, "y" 0.24219136074976833} {"x" -0.5395597743485077, "y" 0.183596676697405} {"x" -0.28356385522049926, "y" 0.17187773988693236} {"x" -0.027567936092490863, "y" 0.1679714276167748} {"x" 0.22842798303551753, "y" 0.17969036442724745} {"x" 0.48442390216352593, "y" 0.1601588030764597} {"x" 0.7404198212915343, "y" 0.17969036442724745} {"x" 0.9964157404195426, "y" 0.19140930123772013} {"x" 1.252411659547551, "y" 0.15625249080630213} {"x" 1.5084075786755593, "y" 0.14453355399582948} {"x" 1.7644034978035676, "y" 0.15625249080630213} {"x" 2.020399416931576, "y" 0.12890830491519925} {"x" 2.2763953360595846, "y" 0.09765780675393884} {"x" 2.532391255187593, "y" 0.1093767435644115} {"x" 2.7883871743156012, "y" 0.07421993313299352} {"x" 3.0443830934436096, "y" 0.05468837178220575} {"x" 3.300379012571618, "y" 0.04687574724189064} {"x" 3.5563749316996263, "y" 0.08203255767330862} {"x" 3.8123708508276346, "y" 0.03906312270157553} {"x" 4.068366769955643, "y" 0.019531561350787766} {"x" 4.324362689083652, "y" 0.01171893681047266} {"x" 4.580358608211661, "y" 0.015625249080630215} {"x" 4.83635452733967, "y" 0.03125049816126043} {"x" 5.0923504464676785, "y" 0.0} {"x" 5.348346365595687, "y" 0.003906312270157554} {"x" 5.604342284723696, "y" 0.007812624540315108} {"x" 5.860338203851705, "y" 0.003906312270157554} {"x" 6.116334122979714, "y" 0.003906312270157554} {"x" 6.3723300421077225, "y" 0.003906312270157554} {"x" 6.628325961235731, "y" 0})} {"name" "bb9becf8-72c7-48f6-b41c-95350245e63d", "values" ({"x" -10, "y" 7.453306344157342E-7} {"x" -9.799999997019768, "y" 1.2227136022020082E-6} {"x" -9.599999994039536, "y" 1.9859008895787535E-6} {"x" -9.399999991059303, "y" 3.1933568466554097E-6} {"x" -9.199999988079071, "y" 5.083869442630077E-6} {"x" -8.999999985098839, "y" 8.013059747248974E-6} {"x" -8.799999982118607, "y" 1.2504301246871565E-5} {"x" -8.599999979138374, "y" 1.9318683610927946E-5} {"x" -8.399999976158142, "y" 2.9549673525896843E-5} {"x" -8.19999997317791, "y" 4.474916120466938E-5} {"x" -7.999999970197678, "y" 6.709252957952864E-5} {"x" -7.799999967217445, "y" 9.959109066711276E-5} {"x" -7.599999964237213, "y" 1.463604937211866E-4} {"x" -7.399999961256981, "y" 2.129532625969202E-4} {"x" -7.199999958276749, "y" 3.0676215890329826E-4} {"x" -6.999999955296516, "y" 4.3749825786254407E-4} {"x" -6.799999952316284, "y" 6.177431317230414E-4} {"x" -6.599999949336052, "y" 8.635680737170301E-4} {"x" -6.39999994635582, "y" 0.0011952046815864247} {"x" -6.1999999433755875, "y" 0.0016377403466157404} {"x" -5.999999940395355, "y" 0.002221799506292808} {"x" -5.799999937415123, "y" 0.002984157484620092} {"x" -5.599999934434891, "y" 0.003968219313121465} {"x" -5.3999999314546585, "y" 0.005224282454218924} {"x" -5.199999928474426, "y" 0.006809491580088464} {"x" -4.999999925494194, "y" 0.008787387543070678} {"x" -4.799999922513962, "y" 0.011226953610745277} {"x" -4.5999999195337296, "y" 0.014201072062040727} {"x" -4.399999916553497, "y" 0.017784325124320887} {"x" -4.199999913573265, "y" 0.022050107061901632} {"x" -3.999999910593033, "y" 0.027067059067306068} {"x" -3.7999999076128006, "y" 0.032894894202544614} {"x" -3.5999999046325684, "y" 0.03957974321387936} {"x" -3.399999901652336, "y" 0.04714921925263572} {"x" -3.199999898672104, "y" 0.0556074645983085} {"x" -2.9999998956918716, "y" 0.06493049855125375} {"x" -2.7999998927116394, "y" 0.07506222540759178} {"x" -2.599999889731407, "y" 0.08591147779981703} {"x" -2.399999886751175, "y" 0.09735045780688895} {"x" -2.1999998837709427, "y" 0.10921489230961066} {"x" -1.9999998807907104, "y" 0.12130613917293559} {"x" -1.7999998778104782, "y" 0.13339536950647682} {"x" -1.599999874830246, "y" 0.1452298146860898} {"x" -1.3999998718500137, "y" 0.1565409146696238} {"x" -1.1999998688697815, "y" 0.1670540488540041} {"x" -0.9999998658895493, "y" 0.17649938643452168} {"x" -0.799999862909317, "y" 0.18462327433935283} {"x" -0.5999998599290848, "y" 0.1911995003838428} {"x" -0.39999985694885254, "y" 0.19603973746572148} {"x" -0.1999998539686203, "y" 0.19900249729156638} {"x" 1.4901161193847656E-7, "y" 0.19999999999999946} {"x" 0.20000015199184418, "y" 0.1990024943261981} {"x" 0.4000001549720764, "y" 0.19603973162328203} {"x" 0.6000001579523087, "y" 0.19119949183655915} {"x" 0.8000001609325409, "y" 0.1846232633349483} {"x" 1.0000001639127731, "y" 0.1764993732842929} {"x" 1.2000001668930054, "y" 0.1670540339182087} {"x" 1.4000001698732376, "y" 0.15654089834113458} {"x" 1.6000001728534698, "y" 0.14522979737334754} {"x" 1.800000175833702, "y" 0.1333953516167646} {"x" 2.0000001788139343, "y" 0.12130612109691333} {"x" 2.2000001817941666, "y" 0.109214874407896} {"x" 2.400000184774399, "y" 0.09735044039927186} {"x" 2.600000187754631, "y" 0.08591146115746827} {"x" 2.8000001907348633, "y" 0.07506220974839269} {"x" 3.0000001937150955, "y" 0.06493048403815777} {"x" 3.2000001966953278, "y" 0.055607451340457185} {"x" 3.40000019967556, "y" 0.04714920730880908} {"x" 3.6000002026557922, "y" 0.03957973259776622} {"x" 3.8000002056360245, "y" 0.03289488488927549} {"x" 4.000000208616257, "y" 0.02706705100069495} {"x" 4.200000211596489, "y" 0.02205010016188641} {"x" 4.400000214576721, "y" 0.017784319294165653} {"x" 4.600000217556953, "y" 0.014201067194954814} {"x" 4.800000220537186, "y" 0.011226949595674444} {"x" 5.000000223517418, "y" 0.008787384269514283} {"x" 5.20000022649765, "y" 0.006809488941886312} {"x" 5.400000229477882, "y" 0.0052242803523266925} {"x" 5.600000232458115, "y" 0.003968217657451668} {"x" 5.800000235438347, "y" 0.002984156195065413} {"x" 6.000000238418579, "y" 0.0022217985130712366} {"x" 6.200000241398811, "y" 0.001637739590084685} {"x" 6.400000244379044, "y" 0.0011952041116685484} {"x" 6.600000247359276, "y" 8.635676490676143E-4} {"x" 6.800000250339508, "y" 6.177428187500568E-4} {"x" 7.00000025331974, "y" 4.3749802968947785E-4} {"x" 7.2000002562999725, "y" 3.0676199434329435E-4} {"x" 7.400000259280205, "y" 2.1295314518666783E-4} {"x" 7.600000262260437, "y" 1.46360410845439E-4} {"x" 7.800000265240669, "y" 9.959103279023577E-5} {"x" 8.000000268220901, "y" 6.709248958927605E-5} {"x" 8.200000271201134, "y" 4.47491338652843E-5} {"x" 8.400000274181366, "y" 2.9549655032275533E-5} {"x" 8.600000277161598, "y" 1.9318671232486508E-5} {"x" 8.80000028014183, "y" 1.2504293048415349E-5} {"x" 9.000000283122063, "y" 8.013054374075417E-6} {"x" 9.200000286102295, "y" 5.083865957875547E-6} {"x" 9.400000289082527, "y" 3.193354610174078E-6} {"x" 9.60000029206276, "y" 1.9858994691522355E-6} {"x" 9.800000295042992, "y" 1.2227127094295497E-6})}), "marks" ({"type" "line", "from" {"data" "1a68e00f-040a-43da-83c2-1c5f0c4c2ba0"}, "properties" {"enter" {"x" {"scale" "x", "field" "data.x"}, "y" {"scale" "y", "field" "data.y"}, "interpolate" {"value" "step-before"}, "fill" {"value" "steelblue"}, "fillOpacity" {"value" 0.4}, "stroke" {"value" "steelblue"}, "strokeWidth" {"value" 2}, "strokeOpacity" {"value" 1}}}} {"type" "line", "from" {"data" "bb9becf8-72c7-48f6-b41c-95350245e63d"}, "properties" {"enter" {"x" {"scale" "x", "field" "data.x"}, "y" {"scale" "y", "field" "data.y"}, "stroke" {"value" "#FF29D2"}, "strokeWidth" {"value" 2}, "strokeOpacity" {"value" 1}}}})}}
;; <=
